import{c as e,a as t,d as a,N as s,b as o,e as r,f as n,g as i,B as u,h as d,i as c,j as l,k as m,u as p,r as h,l as g,w as f,m as v,R as y,C as x,P as D,A as _,o as M,n as S,p as C,t as b,q as N,s as $,v as O,x as T,y as E,z as L,D as I,E as w}from"./vendor.e77115a4.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const P={},k=function(e,t){return t&&0!==t.length?Promise.all(t.map((e=>{if((e=`/AssetManagement-vue3/${e}`)in P)return;P[e]=!0;const t=e.endsWith(".css"),a=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${a}`))return;const s=document.createElement("link");return s.rel=t?"stylesheet":"modulepreload",t||(s.as="script",s.crossOrigin=""),s.href=e,document.head.appendChild(s),t?new Promise(((e,t)=>{s.addEventListener("load",e),s.addEventListener("error",t)})):void 0}))).then((()=>e())):e()};var A=e({history:t(),routes:[{path:"/",name:"home",component:()=>k((()=>import("./index.92682fa6.js")),["assets/index.92682fa6.js","assets/index.f5889716.css","assets/vendor.e77115a4.js"])},{path:"/asset",name:"asset",component:()=>k((()=>import("./index.4140d383.js")),["assets/index.4140d383.js","assets/OperationButtons.d62792c7.js","assets/vendor.e77115a4.js"])},{path:"/account",name:"account",component:()=>k((()=>import("./index.8ec86aac.js")),["assets/index.8ec86aac.js","assets/OperationButtons.d62792c7.js","assets/vendor.e77115a4.js"])},{path:"/fxrate",name:"fxrate",component:()=>k((()=>import("./index.da304362.js")),["assets/index.da304362.js","assets/OperationButtons.d62792c7.js","assets/vendor.e77115a4.js"])}]});function j(e){return()=>v(i,null,{default:()=>v(e)})}const R=[{label:()=>v(y,{to:"/"},(()=>"总资产")),key:"home",icon:j(N)},{label:()=>v(y,{to:"/asset"},(()=>"资产")),key:"asset",icon:j(x)},{label:()=>v(y,{to:"/fxrate"},(()=>"汇率")),key:"fxrate",icon:j(D)},{label:()=>v(y,{to:"/account"},(()=>"账户")),key:"account",icon:j(_)}],B=a({name:"Navbar",components:{NMenu:s,NLayout:o,NLayoutContent:r,NLayoutSider:n,NIcon:i,Bulb:u,BulbOff:d,NInputGroup:c,NInput:l,NButton:m},setup:()=>({menuOptions:R,message:p()}),data:()=>({timer:null,server:""}),methods:{setTimer(){},updateServer(){this.$store.commit("updateServer",this.server),this.$store.dispatch("getConnecting"),this.$store.dispatch("getTotal"),this.$store.dispatch("asset/getData"),this.$store.dispatch("fxrate/getData"),this.$store.dispatch("account/getData")}},beforeMount(){localStorage.getItem("server")&&(this.server=localStorage.getItem("server"),this.updateServer()),this.server=this.$store.state.server,this.setTimer()},mounted(){this.timer=setInterval(this.setTimer,5e3)},computed:{connecting(){return this.$store.state.connecting[0]&&!this.$store.state.connecting[1]?this.$store.commit("pushMessage",{type:"error",text:"后端已断开"}):!this.$store.state.connecting[0]&&this.$store.state.connecting[1]&&this.$store.commit("pushMessage",{type:"success",text:"后端已连接"}),this.$store.state.connecting[1]},hiddenMessage(){if(this.$store.state.messageQueue.length>0){var e=this.$store.state.messageQueue[0];this.message[e.type](e.text),this.$store.commit("removeMessage")}}}}),Q=C("连接");B.render=function(e,t,a,s,o,r){const n=h("n-menu"),i=h("n-layout-content"),u=h("bulb"),d=h("n-icon"),c=h("bulb-off"),l=h("n-input"),m=h("n-button"),p=h("n-input-group"),v=h("n-layout-sider"),y=h("n-layout");return M(),g(y,{"has-sider":"","sider-placement":"right"},{default:f((()=>[S(i,null,{default:f((()=>[S(n,{mode:"horizontal",options:e.menuOptions},null,8,["options"])])),_:1}),S(v,{width:"500"},{default:f((()=>[S(p,null,{default:f((()=>[S(l,{round:"",value:e.server,"onUpdate:value":t[0]||(t[0]=t=>e.server=t),type:"text"},{prefix:f((()=>[e.connecting?(M(),g(d,{key:0,size:"20",color:"#00cc00"},{default:f((()=>[S(u)])),_:1})):(M(),g(d,{key:1,size:"20",color:"#ff0000"},{default:f((()=>[S(c)])),_:1}))])),_:1},8,["value"]),S(m,{round:"",type:"primary",ghost:"",onClick:e.updateServer},{default:f((()=>[Q])),_:1},8,["onClick"])])),_:1}),C(" "+b(e.hiddenMessage),1)])),_:1})])),_:1})};const z={components:{Navbar:B,NLayout:o,NLayoutHeader:$,NLayoutContent:r,NLayoutFooter:O,NMessageProvider:T},setup:()=>({})},V={id:"app"};z.render=function(e,t,a,s,o,r){const n=h("Navbar"),i=h("n-message-provider"),u=h("n-layout-header"),d=h("router-view"),c=h("n-layout-content"),l=h("n-layout");return M(),E("div",V,[S(l,null,{default:f((()=>[S(u,null,{default:f((()=>[S(i,null,{default:f((()=>[S(n)])),_:1})])),_:1}),S(c,null,{default:f((()=>[S(d)])),_:1})])),_:1})])};var q={dumpData:function(e,t){t.forEach((t=>{t.edit=!1,e.push(t)})),e[0].showAdd=!0},create:function(e,t){e.length>0&&(e[0].showAdd=!1),t.showAdd=!0,t.edit=!0,e.splice(0,0,t)},edit:function(e,{id:t,field:a,value:s}){var o=e.find((e=>e.id==t));o&&(o[a]=s)},remove:function(e,t){for(var a=0;a<e.length&&e[a].id!=t;a++);a<e.length&&e.splice(a,1),e[0]&&(e[0].showAdd=!0)}};const G=I({modules:{asset:{namespaced:!0,state:()=>({data:[]}),getters:{url:(e,t,a)=>a.server+"/rest/asset/"},actions:{getData:function({commit:e,getters:t,rootState:a}){L.get(t.url,a.axiosConfig).then((t=>{e("dumpData",t.data)}))},saveData:function({commit:e,state:t,getters:a,rootState:s},o){var r=t.data.find((e=>e.id==o));if(r){if(-1==r.accountId)return void e("pushMessage",{type:"error",text:"请选择账户"},{root:!0});if(!r.amount||r.amount.search(/^[0-9\.\+\-\*\/]+$/)<0)return void e("pushMessage",{type:"error",text:"请输入金额"},{root:!0});L.post(a.url,Object.assign(r,{method:"save"}),s.axiosConfig).then((t=>{e("dumpData",t.data),e("pushMessage",{type:"success",text:"保存成功！"},{root:!0})})).catch((t=>{e("pushMessage",{type:"error",text:""+t},{root:!0})}))}else e("pushMessage",{type:"error",text:"无效id"},{root:!0})},deleteData:function({commit:e,state:t,getters:a,rootState:s},o){var r=t.data.find((e=>e.id==o));r&&(r.id<0?e("remove",o):L.post(a.url,{id:o,method:"delete"},s.axiosConfig).then((t=>{e("dumpData",t.data),e("pushMessage",{type:"success",text:"删除成功！"},{root:!0})})).catch((t=>{e("pushMessage",{type:"error",text:""+t},{root:!0})})))}},mutations:{dumpData(e,t){t.length>0?(e.data=[],q.dumpData(e.data,t)):this.commit("asset/create")},create(e){q.create(e.data,{id:-(new Date).valueOf(),date:(new Date).toISOString().split("T")[0],accountId:-1,amount:void 0})},edit(e,{id:t,field:a,value:s}){q.edit(e.data,{id:t,field:a,value:s})},remove(e,t){q.remove(e.data,t),0==e.data.length&&this.commit("asset/create")}}},account:{namespaced:!0,state:()=>({data:[]}),getters:{url:(e,t,a)=>a.server+"/rest/account/"},actions:{getData:function({commit:e,getters:t,rootState:a}){L.get(t.url,a.axiosConfig).then((t=>{e("dumpData",t.data)}))},saveData:function({commit:e,state:t,getters:a,rootState:s},o){var r=t.data.find((e=>e.id==o));if(r){if(!r.name||!r.currency)return void e("pushMessage",{type:"error",text:"请输入账户名和货币"},{root:!0});L.post(a.url,Object.assign(r,{method:"save"}),s.axiosConfig).then((t=>{e("dumpData",t.data),e("pushMessage",{type:"success",text:"保存成功！"},{root:!0})})).catch((t=>{e("pushMessage",{type:"error",text:""+t},{root:!0})}))}else e("pushMessage",{type:"error",text:"无效id"},{root:!0})},deleteData:function({commit:e,state:t,getters:a,rootState:s},o){var r=t.data.find((e=>e.id==o));r&&(r.id<0?e("remove",o):L.post(a.url,{id:o,method:"delete"},s.axiosConfig).then((t=>{e("dumpData",t.data),e("pushMessage",{type:"success",text:"删除成功！"},{root:!0})})).catch((t=>{e("pushMessage",{type:"error",text:""+t},{root:!0})})))}},mutations:{dumpData(e,t){t.length>0?(e.data=[],q.dumpData(e.data,t)):this.commit("account/create")},create(e){q.create(e.data,{id:-(new Date).valueOf(),name:null,currency:"JPY",is_active:!0})},edit(e,{id:t,field:a,value:s}){q.edit(e.data,{id:t,field:a,value:s})},remove(e,t){q.remove(e.data,t),0==e.data.length&&this.commit("account/create")}}},fxrate:{namespaced:!0,state:()=>({data:[]}),getters:{url:(e,t,a)=>a.server+"/rest/fxrate/"},actions:{getData:function({commit:e,getters:t,rootState:a}){L.get(t.url,a.axiosConfig).then((t=>{e("dumpData",t.data)}))},saveData:function({commit:e,state:t,getters:a,rootState:s},o){var r=t.data.find((e=>e.id==o));if(r){if(!r.rate)return void e("pushMessage",{type:"error",text:"请输入汇率"},{root:!0});L.post(a.url,Object.assign(r,{method:"save"}),s.axiosConfig).then((t=>{e("dumpData",t.data),e("pushMessage",{type:"success",text:"保存成功！"},{root:!0})})).catch((t=>{e("pushMessage",{type:"error",text:""+t},{root:!0})}))}else e("pushMessage",{type:"error",text:"无效id"},{root:!0})},deleteData:function({commit:e,state:t,getters:a,rootState:s},o){var r=t.data.find((e=>e.id==o));r&&(r.id<0?e("remove",o):L.post(a.url,{id:o,method:"delete"},s.axiosConfig).then((t=>{e("dumpData",t.data),e("pushMessage",{type:"success",text:"删除成功！"},{root:!0})})).catch((t=>{e("pushMessage",{type:"error",text:""+t},{root:!0})})))}},mutations:{dumpData(e,t){t.length>0?(e.data=[],q.dumpData(e.data,t)):this.commit("fxrate/create")},create(e){q.create(e.data,{id:-(new Date).valueOf(),date:(new Date).toISOString().split("T")[0],rate:null,currency:"JPY"})},edit(e,{id:t,field:a,value:s}){q.edit(e.data,{id:t,field:a,value:s})},remove(e,t){q.remove(e.data,t),0==e.data.length&&this.commit("fxrate/create")}}}},state:{totals:[],connecting:[!1,!1],server:"http://127.0.0.1:5000",axiosConfig:{timeout:3e3,headers:{"Bypass-Tunnel-Reminder":"a","Access-Control-Allow-Methods":"POST,GET,PUT,DELETE,OPTIONS"}},messageQueue:[]},mutations:{updateTotal(e,t){e.totals=t},updateConnecting(e,t){e.connecting=[e.connecting[1],t]},updateServer(e,t){e.server=t,e.connecting=[e.connecting[1],!1],localStorage.setItem("server",e.server)},removeMessage(e){e.messageQueue.shift()},pushMessage(e,t){e.messageQueue.push(t)}},getters:{},actions:{getTotal:function({commit:e,state:t}){L.get(t.server+"/rest/",t.axiosConfig).then((t=>{e("updateTotal",t.data)}))},getConnecting:function({commit:e,state:t}){L.get(t.server+"/rest/ping/",t.axiosConfig).then((t=>{console.log("ping"),e("updateConnecting",!0)})).catch((t=>{console.log("ping不到"),e("updateConnecting",!1)}))}}});w(z).use(A).use(G).mount("#app");
